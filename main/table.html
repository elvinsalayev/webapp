<!DOCTYPE html>
<html lang="az">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Məhsullar — Cədvəl (Popover — Razor friendly)</title>
    <style>
      :root {
        /* --- DARK (default) --- */
        --bg-start: #030409;
        --bg-end: #071018;
        --background-color: linear-gradient(90deg, #041221 0%, #000000 100%);

        --text-color: #e9eef6;
        --muted: rgba(233, 238, 246, 0.52);

        --card-bg: rgb(10, 14, 18);
        --table-bg: #051117;
        --surface: rgba(255, 255, 255, 0.03);

        --input-bg: rgba(255, 255, 255, 0.02);
        --input-border: rgba(255, 255, 255, 0.116);

        --accent: #ff6b3b;
        --accent-strong: linear-gradient(90deg, #ff5a3c 0%, #ff8b3b 100%);
        --accent-contrast: #0b0b0b;
        --accent-glow: rgba(255, 107, 59, 0.12);

        /* unified border/overlay variables (theme-aware) */
        --border-strong: rgba(255, 255, 255, 0.144);
        --border-mid: rgba(255, 255, 255, 0.137);
        --border-weak: rgba(255, 255, 255, 0.02);
        --border-x: rgba(255, 255, 255, 0.04);
        --hover-surface: rgba(255, 255, 255, 0.185);
        --surface-overlay: rgba(255, 255, 255, 0.01);
        --panel-overlay: rgba(
          20,
          20,
          20,
          0.98
        ); /* fallback for popover in dark */
        --focus-ring: rgba(255, 107, 59, 0.18);
      }

      /* -------- LIGHT theme overrides -------- */
      [data-theme="light"] {
        --bg-start: #fbfdff;
        --bg-end: #f2f6f9;
        --background-color: linear-gradient(90deg, #fbfdff 0%, #f2f6f9 100%);

        --text-color: #0b1a22;
        --muted: rgba(11, 26, 34, 0.56);

        --card-bg: #ffffff;
        --table-bg: #ffffff;
        --surface: rgba(11, 26, 34, 0.03);

        --input-bg: #ffffff;
        --input-border: rgba(11, 26, 34, 0.08);

        --accent: #ff6b3b;
        --accent-strong: linear-gradient(90deg, #ff8b3b 0%, #ff5a3c 100%);
        --accent-contrast: #ffffff;
        --accent-glow: rgba(255, 107, 59, 0.08);

        /* borders / overlays for light theme (dark tinted overlays on light) */
        --border-strong: rgba(11, 26, 34, 0.08);
        --border-mid: rgba(11, 26, 34, 0.06);
        --border-weak: rgba(11, 26, 34, 0.03);
        --border-x: rgba(11, 26, 34, 0.04);
        --hover-surface: rgba(11, 26, 34, 0.04);
        --surface-overlay: rgba(11, 26, 34, 0.01);
        --panel-overlay: rgba(
          255,
          255,
          255,
          0.98
        ); /* popover fallback for light */
        --focus-ring: rgba(255, 107, 59, 0.16);
      }

      /* =========== rest of your original CSS: only color usages replaced by variables =========== */

      * {
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
        background: var(--background-color);
        color: var(--text-color);
      }

      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      .navbar {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 14px 20px;
        background: var(--card-bg);
        border-bottom: 1px solid var(--border-strong);
        position: relative;
        z-index: 20;
      }
      @font-face {
        font-family: Moldie;
        src: url(../fonts/icomoon/MoldieDemo.otf);
      }
      .navbar__brand {
        background-color: #ffffff11;
        border: 3px solid var(--accent);
        padding: 10px;
      }
      .navbar__brand a {
        font-family: Moldie;
        font-size: 30px;
        text-decoration: none;
        color: var(--accent);
      }

      .navbar__brand:hover {
        /* animation: animate 12ms ease-in-out infinite; */
        color: var(--accent);
      }

      @keyframes animate {
        0%,
        100% {
          top: -7px;
          left: 0;
          opacity: 1;
        }
        20% {
          top: 0;
          left: -10px;
          opacity: 0.7;
        }
        40% {
          top: 7px;
          left: 0;
          opacity: 0.2;
        }
        60% {
          top: 0;
          left: 10px;
          opacity: 0.3;
        }
        80% {
          top: 0;
          left: 0;
          opacity: 0.9;
        }
      }

      .nav-center {
        flex: 1;
        display: flex;
        justify-content: center;
      }
      .nav-search {
        display: flex;
        align-items: center;
        gap: 8px;
        width: 60%;
        max-width: 700px;
      }
      .nav-search input[type="search"] {
        flex: 1;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid var(--input-border);
        background: var(--input-bg);
        color: var(--text-color);
        font-size: 15px;
      }
      .nav-search input[type="search"]:focus {
        outline: 1px solid var(--accent);
      }
      .nav-search button {
        padding: 10px 14px;
        border-radius: 10px;
        border: none;
        background: var(--accent-strong);
        color: var(--accent-contrast);
        font-weight: 800;
        cursor: pointer;
      }

      .nav-actions {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .icon-button {
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 10px;
        background: transparent;
        border: 1px solid var(--border-x);
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        position: relative;
        padding: 10px;
      }

      .fa-ellipsis-vertical,
      .fa-heart {
        color: var(--accent);
        font-size: 1.5rem;
      }
      .fa-xmark,
      #clearFavs {
        color: var(--accent);
      }
      .badge {
        position: absolute;
        top: -6px;
        right: -6px;
        background: var(--accent);
        color: var(--accent-contrast);
        font-size: 11px;
        padding: 2px 6px;
        border-radius: 999px;
      }

      .panel {
        position: absolute;
        top: 64px;
        right: 18px;
        min-width: 300px;
        background: var(--card-bg);
        border-radius: 12px;
        padding: 12px;
        box-shadow: 0 18px 48px rgba(0, 0, 0, 0.5);
        display: none;
        flex-direction: column;
        gap: 8px;
        z-index: 80;
        border: 1px solid var(--border-mid);
      }
      .panel.show {
        display: flex;
      }
      .fav-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
        max-height: 320px;
        overflow: auto;
      }
      .fav-item {
        display: flex;
        gap: 10px;
        align-items: center;
        padding: 8px;
        border-radius: 8px;
      }
      .panel h4 {
        margin: 0 0 6px 0;
        color: var(--text-color);
      }
      .panel .empty {
        color: var(--muted);
        padding: 10px;
        text-align: center;
      }

      .menu-panel {
        position: absolute;
        top: 62px;
        right: 18px;
        min-width: 180px;
        background: var(--card-bg);
        border-radius: 10px;
        padding: 8px;
        box-shadow: 0 18px 48px rgba(39, 39, 39, 0.5);
        border: 1px solid var(--border-mid);
        display: none;
        flex-direction: column;
        gap: 6px;
        z-index: 80;
      }
      .menu-panel.show {
        display: flex;
      }
      .menu-panel a {
        padding: 10px;
        border-radius: 8px;
        text-decoration: none;
        color: var(--text-color);
        font-size: 14px;
      }
      .menu-panel a:hover {
        background: var(--hover-surface);
        cursor: pointer;
      }

      .container {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        margin: 16px 0;
        padding-bottom: 12px;
      }

      .card {
        background: var(--table-bg);
        padding: 14px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
        width: 100%;
        max-width: 1400px;
        margin-bottom: 0;
        border: 1px solid var(--border-mid);
      }

      .page-btn {
        padding: 8px 12px;
        border-radius: 8px;
        border: none;
        background: var(--surface-overlay);
        color: var(--text-color);
        cursor: pointer;
      }

      table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        min-width: 900px;
        background: transparent;
      }
      thead th {
        background: linear-gradient(
          180deg,
          var(--surface-overlay),
          rgba(0, 0, 0, 0)
        );
        padding: 12px 14px;
        text-align: left;
        font-size: 13px;
        border-bottom: 1px solid var(--border-mid);
      }
      thead th:last-child {
        text-align: center;
      }
      tbody td {
        border-bottom: 1px solid var(--border-weak);
        font-size: 14px;
        color: var(--text-color);
        vertical-align: middle;
      }
      tbody tr {
        border: 1px solid var(--border-weak);
      }
      tbody tr:hover {
        cursor: pointer;
      }
      tbody tr:hover td {
        color: var(--accent);
        transition: 0.5s;
      }

      .fav-checkbox {
        display: none;
      }
      .fav-container {
        background-color: transparent;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 8px 10px;
        cursor: pointer;
        user-select: none;
        border-radius: 10px;
        /* box-shadow: rgba(46, 46, 46, 0.12) 0px 6px 18px; */
        color: var(--text-color);
        font-size: 14px;
      }
      .fav-container svg {
        width: 20px;
        height: 20px;
        stroke: currentColor;
        fill: none;
        transition: transform 250ms ease, fill 250ms ease, stroke 250ms ease;
      }
      .fav-checkbox:checked + .fav-container svg {
        fill: hsl(6deg 100% 58%);
        stroke: hsl(6deg 100% 58%);
        animation: heartButton 0.9s;
      }

      @keyframes heartButton {
        0% {
          transform: scale(1);
        }
        25% {
          transform: scale(1.25);
        }
        50% {
          transform: scale(1);
        }
        75% {
          transform: scale(1.12);
        }
        100% {
          transform: scale(1);
        }
      }

      .fav-container .action {
        position: relative;
        overflow: hidden;
        display: grid;
        line-height: 1;
      }
      .fav-container .action span {
        display: inline-block;
        transition: transform 0.4s, opacity 0.4s;
        white-space: nowrap;
      }
      .fav-container .action .option-1 {
        transform: translateY(0%);
        opacity: 1;
      }
      .fav-checkbox:checked + .fav-container .action .option-1 {
        transform: translateY(-100%);
        opacity: 0;
      }
      .fav-container .action .option-2 {
        transform: translateY(100%);
        opacity: 0;
      }
      .fav-checkbox:checked + .fav-container .action .option-2 {
        transform: translateY(0%);
        opacity: 1;
      }
      .fav-container.fav {
        box-shadow: 0 8px 28px rgba(255, 80, 80, 0.06);
        transform: translateY(-1px);
      }

      .info-btn {
        width: 30px;
        height: 30px;
        border-radius: 6px;
        border: none;
        background: var(--surface-overlay);
        color: var(--text-color);
        cursor: pointer;
        display: grid;
        place-items: center;
      }

      /* popover: use theme card bg instead of hardcoded rgba */
      .popover {
        position: fixed;
        display: none;
        opacity: 0;
        background: var(--card-bg);
        border-radius: 10px;
        padding: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
        color: var(--text-color);
        z-index: 2000;
        max-width: 92vw;
        min-width: 220px;
        max-height: 70vh;
        overflow: auto;
        transition: opacity 140ms ease;
        outline: none;
        left: 50%;
        border: 1px solid var(--border-mid);
      }
      .popover.open {
        display: block;
        opacity: 1;
      }
      .branch {
        display: flex;
        gap: 8px;
        align-items: center;
        padding: 8px 6px;
        border-radius: 8px;
      }
      .logo {
        border-radius: 4px;
        overflow: hidden;
        display: inline-block;
        justify-content: center;
        align-items: center;
        display: grid;
        place-items: center;
      }
      .logo img {
        width: 35px;
        height: 35px;
      }
      .branch .meta {
        font-size: 13px;
      }
      .branch .meta .name {
        font-weight: 700;
      }
      .branch .meta .phone {
        color: var(--muted);
        font-size: 12px;
        margin-top: 3px;
      }
      .addr-title {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      @media (max-width: 900px) {
        table {
          min-width: 700px;
        }
      }
      @media (max-width: 700px) {
        .nav-search {
          width: 100%;
        }
        table {
          min-width: 600px;
        }
        thead th:nth-child(4),
        tbody td:nth-child(4) {
          display: none;
        }
      }

      .muted {
        color: var(--muted);
        font-size: 13px;
      }
      .highlight {
        box-shadow: 0 6px 30px rgba(255, 120, 60, 0.06);
        transform: translateY(-2px);
        transition: all 300ms ease;
      }

      .pagination {
        display: flex;
        gap: 8px;
        justify-content: center;
        margin-top: 12px;
      }

      /* Footer styles below use same variables — left unchanged structurally */
      .site-footer-v2 {
        background: linear-gradient(180deg, var(--bg-start), var(--bg-end));
        color: var(--text-color);
        padding: 28px 18px 14px;
        border-top: 1px solid var(--border-strong);
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      .footer-cta {
        padding: 14px 0;
        border-bottom: 1px solid var(--border-weak);
      }
      .cta-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 200px;
        max-width: 1200px;
        margin: 0 auto;
        align-items: center;
      }
      .cta-item {
        display: flex;
        gap: 12px;
        align-items: center;
        justify-content: start;
        background: linear-gradient(
          180deg,
          var(--surface-overlay),
          rgba(0, 0, 0, 0)
        );
        padding: 12px 14px;
        border-radius: 10px;
        min-height: 56px;
        transition: transform 0.18s ease, box-shadow 0.18s ease;
      }
      .cta-item:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
      }
      .cta-ico {
        width: 34px;
        height: 34px;
        display: block;
        flex-shrink: 0;
      }
      .cta-ico path {
        fill: var(--accent);
        opacity: 0.98;
      }
      .cta-text {
        line-height: 1.1;
      }
      .cta-text strong {
        display: block;
        font-size: 15px;
        color: var(--text-color);
        font-weight: 700;
      }
      .cta-text span {
        display: block;
        font-size: 13px;
        color: var(--muted);
        margin-top: 4px;
      }

      .footer-main {
        max-width: 1200px;
        margin: 20px auto 6px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        padding-bottom: 6px;
        justify-content: center;
        align-items: center;
      }
      .fm-col {
        padding: 6px 2px;
      }
      .fm-col.about h4,
      .fm-col.subscribe h4 {
        margin: 0 0 8px 0;
        color: var(--text-color);
        font-size: 16px;
        font-weight: 700;
      }
      .about-text {
        color: var(--muted);
        line-height: 1.6;
        font-size: 14px;
        margin-bottom: 12px;
      }

      .subscribe-form {
        display: flex;
        gap: 8px;
        background: var(--card-bg);
        padding: 8px;
        border-radius: 10px;
        align-items: center;
        border: 1px solid var(--border-weak);
      }
      .subscribe-form input {
        flex: 1;
        padding: 10px 12px;
        background: transparent;
        border: 1px solid var(--border-x);
        color: var(--text-color);
        border-radius: 8px;
        font-size: 14px;
        outline: none;
      }
      .subscribe-form input::placeholder {
        color: var(--muted);
        opacity: 0.9;
      }
      .subscribe-form input:focus {
        box-shadow: 0 6px 22px rgba(0, 0, 0, 0.5), 0 6px 18px var(--table-bg);
        border-color: var(--input-border);
      }
      .subscribe-form button {
        background: var(--accent);
        border: none;
        padding: 10px 12px;
        border-radius: 8px;
        display: grid;
        place-items: center;
        cursor: pointer;
        box-shadow: 0 8px 28px var(--accent-glow);
        transition: transform 0.14s ease, box-shadow 0.14s ease;
      }
      .subscribe-form button:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 34px var(--table-bg);
      }
      .subscribe-form button svg {
        width: 18px;
        height: 18px;
        fill: #fff;
        transform: rotate(-6deg);
      }

      .footer-bottom {
        border-top: 1px solid var(--border-weak);
        margin-top: 18px;
        padding-top: 14px;
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
      }
      .footer-bottom small {
        color: var(--muted);
      }

      .sr-only {
        position: absolute;
        left: -9999px;
        top: auto;
        width: 1px;
        height: 1px;
        overflow: hidden;
      }

      @media (max-width: 980px) {
        .footer-main {
          grid-template-columns: 1fr;
        }
        .cta-grid {
          grid-template-columns: 1fr;
        }
      }
      @media (max-width: 520px) {
        .cta-item {
          justify-content: flex-start;
          gap: 10px;
          padding: 10px;
        }
        .cta-text strong {
          font-size: 14px;
        }
        .subscribe-form input {
          font-size: 13px;
          padding: 9px 10px;
        }
      }

      /* ===== minimal theme-toggle button style (place the HTML where you want) ===== */
      .theme-toggle {
        /* display: inline-grid; */
        place-items: center;
        padding: 6px 8px;
        height: 36px;
        min-width: 36px;
        border-radius: 8px;
        border: 1px solid var(--border-x);
        background: var(--card-bg);
        color: var(--text-color);
        cursor: pointer;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <div class="navbar__brand">
        <a href="./search.html" class="brand">logo</a>
      </div>

      <div class="nav-center">
        <form
          id="navbarSearchForm"
          class="nav-search"
          onsubmit="onNavbarSearch(event)"
        >
          <input
            id="navbarSearch"
            type="search"
            placeholder="OEM №, brend, mal adı və ya filial axtar"
            aria-label="Axtar"
          />
          <button type="submit">Axtar</button>
        </form>
      </div>

      <div class="nav-actions">
        <button
          id="navFavBtn"
          class="icon-button"
          aria-expanded="false"
          title="Favoritlər"
        >
          <i class="fa-solid fa-heart"></i
          ><span id="favCount" class="badge" style="display: none">0</span>
        </button>
        <button
          id="navMenuBtn"
          class="icon-button"
          aria-expanded="false"
          title="Menyu"
        >
          <i class="fa-solid fa-ellipsis-vertical"></i>
        </button>
      </div>

      <div id="favPanel" class="panel" style="right: 86px">
        <h4>Favoritlər</h4>
        <div id="favList" class="fav-list">
          <div class="empty">Sənin favoritlərin hələ boşdur.</div>
        </div>
        <div
          style="
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 6px;
          "
        >
          <button id="clearFavs" class="page-btn">Hamısını sil</button>
        </div>
      </div>

      <div
        id="menuPanel"
        class="menu-panel"
        role="menu"
        aria-label="İstifadəçi menyusu"
      >
        <a href="/profile.html" role="menuitem" tabindex="0">Profilim</a>
        <a href="/settings.html" role="menuitem" tabindex="0">Tənzimləmələr</a>
        <!-- Place this button anywhere (navbar, header). JS will attach behavior. -->
        <a
          id="themeToggle"
          class="theme-toggle"
          aria-pressed="false"
          title="Toggle theme"
        ></a>
        <a href="/logout" role="menuitem" tabindex="0">Çıxış</a>
      </div>
    </nav>

    <main class="container">
      <div class="card">
        <div class="table-wrap">
          <table aria-describedby="tableDesc">
            <thead>
              <tr>
                <th>OEM №</th>
                <th>BREND KODU</th>
                <th>BREND ADI</th>
                <th>MAL ADI</th>
                <th>FİLİAL</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="tbody">
              <!-- Example rows — when converting to Razor, keep the .popover HTML static and fill branches server-side -->

              <tr data-id="1244100682">
                <td>1244100682</td>
                <td>3901</td>
                <td>TRW</td>
                <td>Amortisör 220…</td>
                <td class="addr-cell">
                  <div class="addr-title">
                    Nerimanov
                    <button
                      class="info-btn"
                      aria-expanded="false"
                      aria-label="Filial məlumatı"
                      title="Filial məlumatı"
                      data-action="toggle"
                    >
                      <svg
                        width="14"
                        height="14"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        aria-hidden
                      >
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4"></path>
                        <path d="M12 8h.01"></path>
                      </svg>
                    </button>
                  </div>
                  <div
                    class="popover"
                    role="dialog"
                    aria-hidden="true"
                    tabindex="-1"
                  >
                    <div class="branch">
                      <div class="logo">
                        <img src="../images/logos/mercedes-logo.avif" alt="" />
                      </div>
                      <div class="meta">
                        <div class="name">MBZ</div>
                        <div class="phone">050 555 55 55</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">
                        <img src="../images/logos/bmw-logo.avif" alt="" />
                      </div>
                      <div class="meta">
                        <div class="name">BMW</div>
                        <div class="phone">055 444 44 44</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">
                        <img src="../images/logos/toyota-logo.avif" alt="" />
                      </div>
                      <div class="meta">
                        <div class="name">Toyota</div>
                        <div class="phone">070 333 33 33</div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <input
                    class="fav-checkbox"
                    type="checkbox"
                    id="fav-1244100682"
                    aria-label="Favoritə əlavə et"
                  />
                  <label
                    class="fav-container"
                    for="fav-1244100682"
                    data-id="1244100682"
                    role="button"
                    tabindex="0"
                    title="Favoritə əlavə et"
                  >
                    <svg
                      class="feather feather-heart"
                      stroke-linejoin="round"
                      stroke-linecap="round"
                      stroke-width="2"
                      stroke="currentColor"
                      fill="none"
                      viewBox="0 0 24 24"
                      height="24"
                      width="24"
                      xmlns="http://www.w3.org/2000/svg"
                      aria-hidden="true"
                    >
                      <path
                        d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                      ></path>
                    </svg>
                    <div class="action"></div>
                  </label>
                </td>
              </tr>
              <tr data-id="1244100681">
                <td>1244100681</td>
                <td>3897</td>
                <td>FEBI</td>
                <td>Podvesnoy 124…</td>
                <td class="addr-cell">
                  <div class="addr-title">
                    Babek
                    <button
                      class="info-btn"
                      aria-expanded="false"
                      aria-label="Filial məlumatı"
                      title="Filial məlumatı"
                      data-action="toggle"
                    >
                      <svg
                        width="14"
                        height="14"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        aria-hidden
                      >
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4"></path>
                        <path d="M12 8h.01"></path>
                      </svg>
                    </button>
                  </div>
                  <div
                    class="popover"
                    role="dialog"
                    aria-hidden="true"
                    tabindex="-1"
                  >
                    <div class="branch">
                      <div class="logo">M</div>
                      <div class="meta">
                        <div class="name">Babek</div>
                        <div class="phone">MBZ · 050 555 55 55</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">B</div>
                      <div class="meta">
                        <div class="name">Nerimanov</div>
                        <div class="phone">BMW · 055 444 44 44</div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <input
                    class="fav-checkbox"
                    type="checkbox"
                    id="fav-1244100681"
                    aria-label="Favoritə əlavə et"
                  />
                  <label
                    class="fav-container"
                    for="fav-1244100681"
                    data-id="1244100681"
                    role="button"
                    tabindex="0"
                    title="Favoritə əlavə et"
                  >
                    <svg
                      class="feather feather-heart"
                      stroke-linejoin="round"
                      stroke-linecap="round"
                      stroke-width="2"
                      stroke="currentColor"
                      fill="none"
                      viewBox="0 0 24 24"
                      height="24"
                      width="24"
                      xmlns="http://www.w3.org/2000/svg"
                      aria-hidden="true"
                    >
                      <path
                        d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                      ></path>
                    </svg>
                    <div class="action"></div>
                  </label>
                </td>
              </tr>
              <tr data-id="1244100682">
                <td>1244100682</td>
                <td>3901</td>
                <td>TRW</td>
                <td>Amortisör 220…</td>
                <td class="addr-cell">
                  <div class="addr-title">
                    Nerimanov
                    <button
                      class="info-btn"
                      aria-expanded="false"
                      aria-label="Filial məlumatı"
                      title="Filial məlumatı"
                      data-action="toggle"
                    >
                      <svg
                        width="14"
                        height="14"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        aria-hidden
                      >
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4"></path>
                        <path d="M12 8h.01"></path>
                      </svg>
                    </button>
                  </div>
                  <div
                    class="popover"
                    role="dialog"
                    aria-hidden="true"
                    tabindex="-1"
                  >
                    <div class="branch">
                      <div class="logo">M</div>
                      <div class="meta">
                        <div class="name">Babek</div>
                        <div class="phone">MBZ · 050 555 55 55</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">B</div>
                      <div class="meta">
                        <div class="name">Nerimanov</div>
                        <div class="phone">BMW · 055 444 44 44</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">T</div>
                      <div class="meta">
                        <div class="name">Yasamal</div>
                        <div class="phone">Toyota · 070 333 33 33</div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <input
                    class="fav-checkbox"
                    type="checkbox"
                    id="fav-1244100682"
                    aria-label="Favoritə əlavə et"
                  />
                  <label
                    class="fav-container"
                    for="fav-1244100682"
                    data-id="1244100682"
                    role="button"
                    tabindex="0"
                    title="Favoritə əlavə et"
                  >
                    <svg
                      class="feather feather-heart"
                      stroke-linejoin="round"
                      stroke-linecap="round"
                      stroke-width="2"
                      stroke="currentColor"
                      fill="none"
                      viewBox="0 0 24 24"
                      height="24"
                      width="24"
                      xmlns="http://www.w3.org/2000/svg"
                      aria-hidden="true"
                    >
                      <path
                        d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                      ></path>
                    </svg>
                    <div class="action"></div>
                  </label>
                </td>
              </tr>
              <tr data-id="1244100681">
                <td>1244100681</td>
                <td>3897</td>
                <td>FEBI</td>
                <td>Podvesnoy 124…</td>
                <td class="addr-cell">
                  <div class="addr-title">
                    Babek
                    <button
                      class="info-btn"
                      aria-expanded="false"
                      aria-label="Filial məlumatı"
                      title="Filial məlumatı"
                      data-action="toggle"
                    >
                      <svg
                        width="14"
                        height="14"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        aria-hidden
                      >
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4"></path>
                        <path d="M12 8h.01"></path>
                      </svg>
                    </button>
                  </div>
                  <div
                    class="popover"
                    role="dialog"
                    aria-hidden="true"
                    tabindex="-1"
                  >
                    <div class="branch">
                      <div class="logo">M</div>
                      <div class="meta">
                        <div class="name">Babek</div>
                        <div class="phone">MBZ · 050 555 55 55</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">B</div>
                      <div class="meta">
                        <div class="name">Nerimanov</div>
                        <div class="phone">BMW · 055 444 44 44</div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <input
                    class="fav-checkbox"
                    type="checkbox"
                    id="fav-1244100681"
                    aria-label="Favoritə əlavə et"
                  />
                  <label
                    class="fav-container"
                    for="fav-1244100681"
                    data-id="1244100681"
                    role="button"
                    tabindex="0"
                    title="Favoritə əlavə et"
                  >
                    <svg
                      class="feather feather-heart"
                      stroke-linejoin="round"
                      stroke-linecap="round"
                      stroke-width="2"
                      stroke="currentColor"
                      fill="none"
                      viewBox="0 0 24 24"
                      height="24"
                      width="24"
                      xmlns="http://www.w3.org/2000/svg"
                      aria-hidden="true"
                    >
                      <path
                        d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                      ></path>
                    </svg>
                    <div class="action"></div>
                  </label>
                </td>
              </tr>
              <tr data-id="1244100682">
                <td>1244100682</td>
                <td>3901</td>
                <td>TRW</td>
                <td>Amortisör 220…</td>
                <td class="addr-cell">
                  <div class="addr-title">
                    Nerimanov
                    <button
                      class="info-btn"
                      aria-expanded="false"
                      aria-label="Filial məlumatı"
                      title="Filial məlumatı"
                      data-action="toggle"
                    >
                      <svg
                        width="14"
                        height="14"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        aria-hidden
                      >
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4"></path>
                        <path d="M12 8h.01"></path>
                      </svg>
                    </button>
                  </div>
                  <div
                    class="popover"
                    role="dialog"
                    aria-hidden="true"
                    tabindex="-1"
                  >
                    <div class="branch">
                      <div class="logo">M</div>
                      <div class="meta">
                        <div class="name">Babek</div>
                        <div class="phone">MBZ · 050 555 55 55</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">B</div>
                      <div class="meta">
                        <div class="name">Nerimanov</div>
                        <div class="phone">BMW · 055 444 44 44</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">T</div>
                      <div class="meta">
                        <div class="name">Yasamal</div>
                        <div class="phone">Toyota · 070 333 33 33</div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <input
                    class="fav-checkbox"
                    type="checkbox"
                    id="fav-1244100682"
                    aria-label="Favoritə əlavə et"
                  />
                  <label
                    class="fav-container"
                    for="fav-1244100682"
                    data-id="1244100682"
                    role="button"
                    tabindex="0"
                    title="Favoritə əlavə et"
                  >
                    <svg
                      class="feather feather-heart"
                      stroke-linejoin="round"
                      stroke-linecap="round"
                      stroke-width="2"
                      stroke="currentColor"
                      fill="none"
                      viewBox="0 0 24 24"
                      height="24"
                      width="24"
                      xmlns="http://www.w3.org/2000/svg"
                      aria-hidden="true"
                    >
                      <path
                        d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                      ></path>
                    </svg>
                    <div class="action"></div>
                  </label>
                </td>
              </tr>
              <tr data-id="1244100681">
                <td>1244100681</td>
                <td>3897</td>
                <td>FEBI</td>
                <td>Podvesnoy 124…</td>
                <td class="addr-cell">
                  <div class="addr-title">
                    Babek
                    <button
                      class="info-btn"
                      aria-expanded="false"
                      aria-label="Filial məlumatı"
                      title="Filial məlumatı"
                      data-action="toggle"
                    >
                      <svg
                        width="14"
                        height="14"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        aria-hidden
                      >
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4"></path>
                        <path d="M12 8h.01"></path>
                      </svg>
                    </button>
                  </div>
                  <div
                    class="popover"
                    role="dialog"
                    aria-hidden="true"
                    tabindex="-1"
                  >
                    <div class="branch">
                      <div class="logo">M</div>
                      <div class="meta">
                        <div class="name">Babek</div>
                        <div class="phone">MBZ · 050 555 55 55</div>
                      </div>
                    </div>
                    <div class="branch">
                      <div class="logo">B</div>
                      <div class="meta">
                        <div class="name">Nerimanov</div>
                        <div class="phone">BMW · 055 444 44 44</div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <input
                    class="fav-checkbox"
                    type="checkbox"
                    id="fav-1244100681"
                    aria-label="Favoritə əlavə et"
                  />
                  <label
                    class="fav-container"
                    for="fav-1244100681"
                    data-id="1244100681"
                    role="button"
                    tabindex="0"
                    title="Favoritə əlavə et"
                  >
                    <svg
                      class="feather feather-heart"
                      stroke-linejoin="round"
                      stroke-linecap="round"
                      stroke-width="2"
                      stroke="currentColor"
                      fill="none"
                      viewBox="0 0 24 24"
                      height="24"
                      width="24"
                      xmlns="http://www.w3.org/2000/svg"
                      aria-hidden="true"
                    >
                      <path
                        d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                      ></path>
                    </svg>
                    <div class="action"></div>
                  </label>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div
          class="pagination"
          role="navigation"
          aria-label="Cədvəl səhifələnməsi"
        >
          <button class="page-btn" id="prevBtn" disabled>«</button>
          <button class="page-btn" id="nextBtn">»</button>
        </div>
      </div>
    </main>
    <!-- FOOTER (copy into your page) -->
    <footer class="site-footer-v2" aria-labelledby="footer-heading">
      <div class="footer-cta">
        <div class="cta-grid">
          <div class="cta-item">
            <svg class="cta-ico" viewBox="0 0 24 24" aria-hidden>
              <path
                d="M12 2C8 2 5 5 5 9c0 6.25 7 13 7 13s7-6.75 7-13c0-4-3-7-7-7zm0 9.5A2.5 2.5 0 1 1 12 6.5a2.5 2.5 0 0 1 0 5z"
              />
            </svg>
            <div class="cta-text">
              <strong>Ünvan</strong><span>1010 Avenue, SW 54321, Bakı</span>
            </div>
          </div>

          <div class="cta-item">
            <svg class="cta-ico" viewBox="0 0 24 24" aria-hidden>
              <path
                d="M6.6 10.2a15.05 15.05 0 0 0 7.2 7.2l2-2a1 1 0 0 1 1-.2c1.1.4 2.4.6 3.7.6a1 1 0 0 1 1 1V20a1 1 0 0 1-1 1C10.1 21 3 13.9 3 4a1 1 0 0 1 1-1h2.5a1 1 0 0 1 1 1c0 1.4.2 2.6.6 3.7a1 1 0 0 1-.2 1l-2 2z"
              />
            </svg>
            <div class="cta-text">
              <strong>Zəng</strong><span>+994 50 555 55 55</span>
            </div>
          </div>

          <div class="cta-item">
            <svg class="cta-ico" viewBox="0 0 24 24" aria-hidden>
              <path
                d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 4-8 5L4 8V6l8 5 8-5v2z"
              />
            </svg>
            <div class="cta-text">
              <strong>E-poçt</strong><span>mail@info.com</span>
            </div>
          </div>
        </div>
      </div>

      <div class="footer-main">
        <div class="fm-col about">
          <h4>Abunə ol</h4>
          <p>Yeniliklərdən xəbərdar olmaq üçün e-poçtunu bura yaz.</p>
        </div>

        <div class="fm-col subscribe">
          <form
            class="subscribe-form"
            action="#"
            onsubmit="event.preventDefault(); alert('Subscribed!');"
          >
            <input
              type="email"
              name="email"
              placeholder="Nümunə: mail@site.com"
              required
            />
            <button aria-label="Subscribe" type="submit">
              <svg viewBox="0 0 24 24" aria-hidden>
                <path d="M2 21l21-9L2 3v7l15 2-15 2z" />
              </svg>
            </button>
          </form>
        </div>
      </div>

      <div class="footer-bottom">
        <div class="fb-left">
          <small
            >&copy; <span id="year"></span> Logo. Bütün hüquqlar qorunur.</small
          >
        </div>
      </div>
    </footer>

    <script>
      // (JS left unchanged from your last working version: popover controller, favorites, search, panels)
      // For brevity I'm keeping JS as-is; only layout got fixed.
      /* ------------ Helpers ------------ */
      function escapeHtml(s) {
        return String(s).replace(/[&<>"']/g, function (c) {
          return {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#39;",
          }[c];
        });
      }

      /* Popover controller (same robust implementation) */
      (function () {
        const M = 8;
        let openPop = null,
          openToggle = null,
          rafId = null;
        function positionPopover(toggle, pop) {
          if (!toggle || !pop) return;
          const btn = toggle.getBoundingClientRect();
          const vw = Math.max(
            document.documentElement.clientWidth,
            window.innerWidth || 0
          );
          const vh = Math.max(
            document.documentElement.clientHeight,
            window.innerHeight || 0
          );
          pop.style.display = "block";
          pop.style.visibility = "hidden";
          pop.classList.add("open");
          const pr = pop.getBoundingClientRect();
          let top = Math.round(btn.bottom + M);
          let left = Math.round(btn.left + btn.width / 2 - pr.width / 2);
          left = Math.max(M, Math.min(left, vw - pr.width - M));
          if (top + pr.height + M > vh) {
            const above = Math.round(btn.top - M - pr.height);
            if (above >= M) top = above;
            else {
              const spaceBelow = Math.max(0, vh - (btn.bottom + M));
              const spaceAbove = Math.max(0, btn.top - M);
              const wantH = Math.max(spaceBelow, spaceAbove, 80);
              pop.style.maxHeight = wantH + "px";
              const pr2 = pop.getBoundingClientRect();
              if (spaceBelow >= spaceAbove) top = Math.round(btn.bottom + M);
              else top = Math.round(Math.max(M, btn.top - M - pr2.height));
            }
          }
          pop.style.left = left + "px";
          pop.style.top = top + "px";
          pop.style.visibility = "";
        }
        function open(pop, toggle) {
          if (!pop || !toggle) return;
          if (openPop === pop) {
            close();
            return;
          }
          close();
          openPop = pop;
          openToggle = toggle;
          pop.setAttribute("aria-hidden", "false");
          toggle.setAttribute("aria-expanded", "true");
          pop.classList.add("open");
          pop.style.display = "block";
          pop.style.opacity = "1";
          positionPopover(toggle, pop);
          try {
            pop.focus();
          } catch (e) {}
          document.addEventListener("pointerdown", onDocPointerDown, true);
          window.addEventListener("resize", onReposition);
          window.addEventListener("orientationchange", onReposition);
          window.addEventListener("scroll", onReposition, true);
          pop.addEventListener("keydown", onPopKey);
        }
        function close() {
          if (!openPop) return;
          const pop = openPop,
            toggle = openToggle;
          pop.classList.remove("open");
          pop.setAttribute("aria-hidden", "true");
          pop.style.display = "none";
          pop.style.maxHeight = "";
          pop.style.left = "";
          pop.style.top = "";
          if (toggle) toggle.setAttribute("aria-expanded", "false");
          try {
            if (toggle && typeof toggle.focus === "function") toggle.focus();
          } catch (e) {}
          document.removeEventListener("pointerdown", onDocPointerDown, true);
          window.removeEventListener("resize", onReposition);
          window.removeEventListener("orientationchange", onReposition);
          window.removeEventListener("scroll", onReposition, true);
          pop.removeEventListener("keydown", onPopKey);
          openPop = null;
          openToggle = null;
          if (rafId) {
            cancelAnimationFrame(rafId);
            rafId = null;
          }
        }
        function onDocPointerDown(e) {
          if (!openPop || !openToggle) return;
          const insidePop = openPop.contains(e.target);
          const onToggle = openToggle.contains(e.target);
          if (!insidePop && !onToggle) close();
        }
        function onReposition() {
          if (!openPop || !openToggle) return;
          if (rafId) cancelAnimationFrame(rafId);
          rafId = requestAnimationFrame(() => {
            positionPopover(openToggle, openPop);
            rafId = null;
          });
        }
        function onPopKey(e) {
          if (e.key === "Escape" || e.key === "Esc") {
            e.preventDefault();
            close();
          }
        }
        document.addEventListener("click", function (e) {
          const toggle = e.target.closest('[data-action="toggle"]');
          if (!toggle) return;
          e.preventDefault();
          const cell = toggle.closest(".addr-cell");
          if (!cell) return;
          const pop = cell.querySelector(".popover");
          if (!pop) return;
          open(pop, toggle);
        });
        document.addEventListener("keydown", function (e) {
          const el = document.activeElement;
          if (!el) return;
          if (el.matches && el.matches('[data-action="toggle"], .info-btn')) {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              el.click();
            }
          }
        });
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape" || e.key === "Esc") close();
        });
        window.__slidePopoverClose = close;
      })();

      /* Favorites, panels, search — keep as before (omitted here for brevity) */
      (function () {
        /* favorites & panels code (same as you had) */
        /* ... your favorites/panels code ... */
        // For demo, minimal favorites logic:
        const FAV_KEY = "slide_favorites_v1";
        const navFavBtn = document.getElementById("navFavBtn");
        const favPanel = document.getElementById("favPanel");
        const favListEl = document.getElementById("favList");
        const favCountEl = document.getElementById("favCount");
        const tbody = document.getElementById("tbody");
        function loadFavs() {
          try {
            const raw = localStorage.getItem(FAV_KEY);
            return raw ? JSON.parse(raw) : [];
          } catch (e) {
            return [];
          }
        }
        function saveFavs(list) {
          localStorage.setItem(FAV_KEY, JSON.stringify(list));
          renderFavs();
          updateFavButtons();
        }
        function renderFavs() {
          const list = loadFavs();
          favListEl.innerHTML = "";
          if (!list.length) {
            favListEl.innerHTML =
              '<div class="empty">Sənin favoritlərin hələ boşdur.</div>';
            favCountEl.style.display = "none";
            return;
          }
          favCountEl.style.display = "inline-block";
          favCountEl.textContent = String(list.length);
          list.forEach((item) => {
            const el = document.createElement("div");
            el.className = "fav-item";
            el.innerHTML = `<div style="flex:1;"><div class="meta"><strong>${escapeHtml(
              item.brand || item.name || "—"
            )}</strong></div><div class="muted" style="font-size:13px">${escapeHtml(
              item.oem || ""
            )} · ${escapeHtml(
              item.place || ""
            )}</div></div><div style="display:flex;gap:8px;align-items:center;color:red;"><button class="page-btn" data-action="remove" data-id="${escapeHtml(
              item.id
            )}"><i class="fa-solid fa-xmark"></i></button></div>`;
            favListEl.appendChild(el);
          });
        }
        function updateFavButtons() {
          const favs = loadFavs();
          document.querySelectorAll(".fav-checkbox").forEach((input) => {
            const tr = input.closest("tr");
            const id = tr.dataset.id;
            const found = favs.find((f) => f.id === id);
            input.checked = !!found;
            const label = tr.querySelector(".fav-container");
            if (found) {
              label.classList.add("fav");
              label.setAttribute("title", "Favoritdən sil");
              input.setAttribute("aria-pressed", "true");
            } else {
              label.classList.remove("fav");
              label.setAttribute("title", "Favoritə əlavə et");
              input.setAttribute("aria-pressed", "false");
            }
          });
        }
        tbody.addEventListener("change", function (e) {
          const input = e.target.closest(".fav-checkbox");
          if (!input) return;
          const tr = input.closest("tr");
          const id = tr.dataset.id;
          const brand = tr.children[3] ? tr.children[3].textContent.trim() : "";
          const oem = tr.children[1] ? tr.children[1].textContent.trim() : "";
          const place = tr.querySelector(".addr-title")
            ? tr.querySelector(".addr-title").textContent.trim()
            : "";
          let favs = loadFavs();
          const idx = favs.findIndex((f) => f.id === id);
          if (input.checked) {
            if (idx === -1) favs.unshift({ id, brand, oem, place });
            saveFavs(favs);
          } else {
            if (idx >= 0) {
              favs.splice(idx, 1);
              saveFavs(favs);
            } else updateFavButtons();
          }
        });
        navFavBtn.addEventListener("click", function () {
          const open = favPanel.classList.toggle("show");
          navFavBtn.setAttribute("aria-expanded", String(open));
          if (open) {
            document
              .getElementById("navMenuBtn")
              .setAttribute("aria-expanded", "false");
          }
          renderFavs();
        });
        favListEl.addEventListener("click", function (e) {
          const a = e.target.closest("[data-action]");
          if (!a) return;
          const act = a.dataset.action;
          const id = a.dataset.id;
          if (act === "goto") {
            const row = document.querySelector(`tbody tr[data-id="${id}"]`);
            if (row) {
              row.scrollIntoView({ behavior: "smooth", block: "center" });
              row.classList.add("highlight");
              setTimeout(() => row.classList.remove("highlight"), 1200);
            }
          }
          if (act === "remove") {
            let favs = loadFavs();
            favs = favs.filter((f) => f.id !== id);
            saveFavs(favs);
          }
        });
        document
          .getElementById("clearFavs")
          .addEventListener("click", function () {
            if (confirm("Bütün favoritləri silmək istədiyinizə əminsiniz?")) {
              localStorage.removeItem(FAV_KEY);
              renderFavs();
              updateFavButtons();
            }
          });
        renderFavs();
        updateFavButtons();
      })();

      function onNavbarSearch(e) {
        e.preventDefault();
        const q = document.getElementById("navbarSearch").value.trim();
        if (!q) return document.getElementById("navbarSearch").focus();
        const params = new URLSearchParams({ q });
        window.location.href = "/table.html?" + params.toString();
      }

      const navMenuBtn = document.getElementById("navMenuBtn");
      const menuPanel = document.getElementById("menuPanel");
      navMenuBtn.addEventListener("click", function () {
        const open = menuPanel.classList.toggle("show");
        navMenuBtn.setAttribute("aria-expanded", String(open));
        if (open) {
          document
            .getElementById("navFavBtn")
            .setAttribute("aria-expanded", "false");
          document.getElementById("favPanel").classList.remove("show");
        }
      });

      document.addEventListener(
        "pointerdown",
        function (e) {
          const path = e.composedPath ? e.composedPath() : e.path || [];
          if (
            !path.includes(document.getElementById("favPanel")) &&
            !path.includes(document.getElementById("navFavBtn"))
          )
            document.getElementById("favPanel").classList.remove("show");
          if (
            !path.includes(document.getElementById("menuPanel")) &&
            !path.includes(document.getElementById("navMenuBtn"))
          )
            document.getElementById("menuPanel").classList.remove("show");
        },
        true
      );

      document.getElementById("year").textContent = new Date().getFullYear();

      (function () {
        const y = document.getElementById("year");
        if (y) y.textContent = new Date().getFullYear();
      })();
    </script>
    <script>
      (function () {
        const KEY = "site_theme_v1";
        // determine initial theme: saved -> system preference -> dark fallback
        const saved = localStorage.getItem(KEY);
        let theme =
          saved ||
          (window.matchMedia &&
          window.matchMedia("(prefers-color-scheme: light)").matches
            ? "light"
            : "dark");
        function apply(t) {
          document.documentElement.setAttribute("data-theme", t);
          localStorage.setItem(KEY, t);
          const btn = document.getElementById("themeToggle");
          if (btn) {
            btn.setAttribute("aria-pressed", String(t === "light"));
            btn.textContent = t === "light" ? "Dark theme 🌙" : "Light theme☀️";
          }
        }
        apply(theme);

        // attach toggle click (will work even if button is added later)
        document.addEventListener("click", function (e) {
          const btn = e.target.closest("#themeToggle");
          if (!btn) return;
          theme =
            document.documentElement.getAttribute("data-theme") === "light"
              ? "dark"
              : "light";
          apply(theme);
        });
      })();
    </script>

    <script
      src="https://kit.fontawesome.com/a446eb9fda.js"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
